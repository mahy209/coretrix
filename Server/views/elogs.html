<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.1/css/materialize.min.css"
        media="screen,projection,print" />
    <link media="all" type="text/css" rel="stylesheet" href="/assets/css/style.css">
    <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css" />
    <link type="text/css" rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/css/bootstrap-datepicker.standalone.css"
    />
    <link type="text/css" rel="stylesheet" href="/assets/css/responsive-shit.css" />
    <link media="all" type="text/css" rel="stylesheet" href="/assets/css/report-page.css">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.4/angular.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.0/fuse.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.1.4/js.cookie.min.js"></script>
    <script type="text/javascript" src="/assets/js/libs/library.js"></script>
    <script type="text/javascript" src="/assets/js/scripts/helpers.js"></script>
    <script type="text/javascript" src="/assets/js/scripts/liveorlocal.js"></script>
    <script type="text/javascript" src="/assets/js/scripts/sdk.js"></script>
    <script type="text/javascript" src="/assets/js/scripts/exam_logs.js"></script>
</head>

<body ng-app="coretrix" class="grey lighten-2" style="direction: rtl;">
    <head>
        <title>{{title}}</title>
    </head>
    <div class="contanier-fluid" ng-controller="mainCtrl">
        <div class="row">
            <div class="container">
                <div class="showonprint">
                    <h3 class="center-align">{{selected_exam.name}}</h3>
                    <h6 class="center-align">{{'الصف ' + grades_names[selected_grade]}}</h6>
                </div>
                <div class="card-panel col l12 m12 s12 hide_on_mobile hideonprint animated slideInDown" style="padding:2%; margin-bottom:2%;margin-top:2%;" id="exam_selector">
                    <h4 class="center-align">إختيار الإمتحان</h4>
                     <div class="row">
                       <div class="col s6">
                         <label>الإمتحان</label>
                         <select class="browser-default" ng-options="e as e.name for e in exams" ng-change="reload()" ng-model="selected_exam">
                             <option value="" disabled selected>اختر الإمتحان</option>
                         </select>
                       </div>
                       <div class="col s6 ">
                         <label>السنه الدراسيه</label>
                         <select class="browser-default" ng-options="i as grades_names[i] for i in grades" ng-change="grade_changed()" ng-model="selected_grade">
                             <option value="" disabled selected>السنه</option>
                         </select>
                       </div>

                    </div>
                    <div style="margin-top:2%;">
                        <button ng-click="prepareExamDel()" style="margin-left:0.5%" class="btn red btn tooltipped" data-position="bottom" data-tooltip="امسح الإمتحان">
                            <i class="fa fa-trash" aria-hidden="true"></i>
                        </button>
                        <button href="#addExam_modal" style="margin-left:0.5%" class="btn modal-trigger btn tooltipped" data-position="bottom" data-tooltip="أضف إمتحان">
                            <i class="fa fa-plus-square" aria-hidden="true"></i>
                        </button>
                        <button ng-click="printPage()" style="left: 0;" class="btn blue-grey-background">إطبع</button>
                    </div>
                </div>
                <div id="deleteExam_modal" class="modal">
                    <div class="modal-content gradient">
                        <h4>هل تريد حذف الإمتحان ؟</h4>
                        <p>عند حذف الإمتحان لا يمكنك استرجاع بياناته</p>
                    </div>
                    <div class="modal-footer gradient2">
                        <a ng-click="delete_exam()" class="modal-action modal-close waves-effect waves-green btn-flat">اوافق</a>
                        <a class="modal-action modal-close waves-effect waves-red btn-flat">لا</a>
                    </div>
                </div>
                <div id="addExam_modal" class="modal animated slideInDown">
                    <div class="modal-content">
                        <div class="row">
                            <div class="col s12">
                                <label>اسم الامتحان</label>
                                <input type="text" ng-model="newExam_name">
                            </div>
                            <div class="col s6">
                                <label>الخط الأحمر</label>
                                <input type="number" max="{{newExam_max}}" ng-model="newExam_redline">
                            </div>
                            <div class="col s6">
                                <label>الدرجة النهائية</label>
                                <input type="number" ng-model="newExam_max">
                            </div>
                            <div class="col s12">
                                <label>اختر السنه</label>
                                <select class="browser-default" ng-model="addExam_selectedGrade" ng-options="g as grades_names[g] for g in allowedGrades">
                                    <option value="" disabled selected>اختر السنه</option>
                                </select>
                            </div>
                        </div>
                        <div class="modal-footer gradient2">
                            <a ng-click="addExam()" class="waves-effect waves-green btn-flat">أضف الإمتحان</a>
                            <a class="modal-action modal-close waves-effect waves-red btn-flat">إلغاء</a>
                        </div>
                    </div>
                </div>
                <div class="col s12 l6 m6  animated slideInUp hideonprint">
                  <div class="row">
                      <div class="col s12 l8 m8">
                        <input ng-model="searchText" ng-keypress="logSearchedAttendance($event)" ng-change="search()" class="autocomplete searchitem"
                            style="padding-right: 1%; /* for the text */" placeholder="ابحث عن طالب" id="searchStudents" type="search"
                            required>
                      </div>
                      <div class="col s4">
                          <button class="btn-flat search-filter waves-effect btn_switch" style="margin-left:4%;">اعدادات</button>
                        </div>
                  </div>
                </div>
                <div class="logs hide_on_mobile">
                    <table class="animated slideInUp">
                        <tr>
                            <th>
                                اسم الطالب
                            </th>
                            <th>
                                الدرجة
                            </th>
                        </tr>
                        <tr ng-repeat="n in logs">
                            <td style="width: 25%">
                                <p style="display:inline;">
                                    <input type="checkbox" ng-model="n.log.attendant" ng-change="attendanceChanged(n)" id="cid{{n.studentid}}" />
                                    <label for="cid{{n.studentid}}">{{n.codeName}}</label>
                                    <i style="margin-right:3%">{{n.fullname}}</i>
                                </p>
                            </td>
                            <td style="width: 20%">
                                <p class="showonprint">{{n.log.mark ? (n.log.mark + ' / ' + selected_exam.max_mark) : 'لم تسجل درجة للطالب'}}</p>
                                <div class="hideonprint" style="display: inline-flex">
                                    <input ng-init="n.log.mark = n.log.mark ? n.log.mark : 0" type="number" ng-model="n.log.mark" ng-blur="markChanged(n)">
                                    <p style="width: 100%; margin-right: 8%; direction: ltr; font-size: larger;">{{selected_exam.max_mark}} من</p>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="logs only_on_mobile">
                    <table class="animated slideInUp">
                        <tr>
                            <th>
                                اسم الطالب
                            </th>
                            <th>
                                الدرجة
                            </th>
                        </tr>
                        <tr ng-repeat="n in logs">
                            <td style="width:70%;">
                                <p style="display:inline;">
                                    <input type="checkbox" ng-model="n.log.attendant" ng-change="attendanceChanged(n)" id="cid{{n.studentid}}" />
                                    <label for="cid{{n.studentid}}">{{n.codeName}}</label>
                                    <i>{{n.fullname}}</i>
                                </p>
                            </td>
                            <td>
                                <p class="showonprint">{{n.log.mark ? (n.log.mark + ' / ' + selected_exam.max_mark) : 'لم تسجل درجة للطالب'}}</p>
                                <div class="hideonprint" style="display: inline-flex">
                                    <input ng-init="n.log.mark = n.log.mark ? n.log.mark : 0" type="number" ng-model="n.log.mark" ng-blur="markChanged(n)">
                                    <p style="width: 100%; direction: ltr; font-size: larger;">{{selected_exam.max_mark}} /</p>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>

            </div>
        </div>
        <!--Import jQuery before materialize.js-->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/js/bootstrap-datepicker.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.1/js/materialize.min.js"></script>
        <script type="text/javascript">
            $(document).ready(function () {
                $('.modal').modal();
                $('.tooltipped').tooltip({
                    delay: 50
                });
                $(".btn_switch").click(function () {
                    $("#exam_selector").slideToggle("slow");
                });
            });
            $("#exam_selector").css("display","none");
        </script>
        <script type="text/javascript" src="/assets/js/scripts/selectonfocus.js"></script>
</body>

</html>
